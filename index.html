
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Iroha API reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
    <script>
      ((window.gitter = {}).chat = {}).options = {
        room: 'hyperledger-iroha/Lobby'
      };
    </script>
  <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
</head>

  <body class="index" data-languages="[&quot;protobuf&quot;,&quot;json&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="protobuf">protobuf</a>
              <a href="#" data-language-name="json">json</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#overview" class="toc-h1 toc-link" data-title="Overview">Overview</a>
          </li>
          <li>
            <a href="#build" class="toc-h1 toc-link" data-title="Build">Build</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#docker" class="toc-h2 toc-link" data-title="Build">Docker</a>
                  </li>
                  <li>
                    <a href="#linux-or-macos" class="toc-h2 toc-link" data-title="Build">Linux or macOS</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#transactions" class="toc-h1 toc-link" data-title="Transactions">Transactions</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#transaction-structure" class="toc-h2 toc-link" data-title="Transactions">Transaction structure</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#commands" class="toc-h1 toc-link" data-title="Commands">Commands</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#add-asset-quantity" class="toc-h2 toc-link" data-title="Commands">Add asset quantity</a>
                  </li>
                  <li>
                    <a href="#add-peer" class="toc-h2 toc-link" data-title="Commands">Add peer</a>
                  </li>
                  <li>
                    <a href="#add-signatory" class="toc-h2 toc-link" data-title="Commands">Add signatory</a>
                  </li>
                  <li>
                    <a href="#create-asset" class="toc-h2 toc-link" data-title="Commands">Create asset</a>
                  </li>
                  <li>
                    <a href="#create-account" class="toc-h2 toc-link" data-title="Commands">Create account</a>
                  </li>
                  <li>
                    <a href="#create-domain" class="toc-h2 toc-link" data-title="Commands">Create domain</a>
                  </li>
                  <li>
                    <a href="#remove-signatory" class="toc-h2 toc-link" data-title="Commands">Remove signatory</a>
                  </li>
                  <li>
                    <a href="#set-account-quorum" class="toc-h2 toc-link" data-title="Commands">Set account quorum</a>
                  </li>
                  <li>
                    <a href="#transfer-asset" class="toc-h2 toc-link" data-title="Commands">Transfer asset</a>
                  </li>
                  <li>
                    <a href="#subtract-asset-quantity" class="toc-h2 toc-link" data-title="Commands">Subtract asset quantity</a>
                  </li>
                  <li>
                    <a href="#append-role" class="toc-h2 toc-link" data-title="Commands">Append role</a>
                  </li>
                  <li>
                    <a href="#create-role" class="toc-h2 toc-link" data-title="Commands">Create role</a>
                  </li>
                  <li>
                    <a href="#grant-permission" class="toc-h2 toc-link" data-title="Commands">Grant permission</a>
                  </li>
                  <li>
                    <a href="#revoke-permission" class="toc-h2 toc-link" data-title="Commands">Revoke permission</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#queries" class="toc-h1 toc-link" data-title="Queries">Queries</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#query-structure" class="toc-h2 toc-link" data-title="Queries">Query structure</a>
                  </li>
                  <li>
                    <a href="#get-account" class="toc-h2 toc-link" data-title="Queries">Get account</a>
                  </li>
                  <li>
                    <a href="#get-signatories" class="toc-h2 toc-link" data-title="Queries">Get signatories</a>
                  </li>
                  <li>
                    <a href="#get-account-transactions" class="toc-h2 toc-link" data-title="Queries">Get account transactions</a>
                  </li>
                  <li>
                    <a href="#get-account-asset-transactions" class="toc-h2 toc-link" data-title="Queries">Get account asset transactions</a>
                  </li>
                  <li>
                    <a href="#get-account-assets" class="toc-h2 toc-link" data-title="Queries">Get account assets</a>
                  </li>
                  <li>
                    <a href="#get-asset-info" class="toc-h2 toc-link" data-title="Queries">Get asset info</a>
                  </li>
                  <li>
                    <a href="#get-roles" class="toc-h2 toc-link" data-title="Queries">Get roles</a>
                  </li>
                  <li>
                    <a href="#get-role-permissions" class="toc-h2 toc-link" data-title="Queries">Get role permissions</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#command-line-interface" class="toc-h1 toc-link" data-title="Command Line Interface">Command Line Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#interactive-mode" class="toc-h2 toc-link" data-title="Command Line Interface">Interactive mode </a>
                  </li>
                  <li>
                    <a href="#starting-menu" class="toc-h2 toc-link" data-title="Command Line Interface">Starting menu </a>
                  </li>
                  <li>
                    <a href="#transaction-cli" class="toc-h2 toc-link" data-title="Command Line Interface">Transaction CLI</a>
                  </li>
                  <li>
                    <a href="#query-cli" class="toc-h2 toc-link" data-title="Command Line Interface">Query CLI</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://github.com/hyperledger/iroha'>Hyperledger Iroha GitHub</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='overview'>Overview</h1>
<p>Welcome to the Hyperledger Iroha API docs!</p>

<iframe width="560" height="315" style="padding-left: 28px" src="https://www.youtube.com/embed/Hf_5j0b6TZM" frameborder="0" allowfullscreen></iframe>

<p>This API allows users to send transactions to peer network, containing one or many commands to perform allowed actions in the system, and also make queries to know current state.
Users are authenticated by their keypair and account id, passed as the parameter with their transactions or queries.</p>

<p>The API is organized around protobuf format, as Iroha is using gRPC on transport level. Iroha CLI and blockstore works with JSON format to provide developer-friendly experience for community members.  </p>

<p>To try out a basic API request, do the following:</p>

<ol>
<li>Run the system (<code>irohad</code> daemon) on a single node</li>
<li>Run iroha-cli in interactive mode</li>
<li>Select a necessary action to perform</li>
<li>Send formed protobuf via gRPC call</li>
<li>Get a response from the system </li>
</ol>

<aside class="notice"> Right now, responses for trasaction status are not retrieved from the CLI. ETA is October 2017. </aside>
<h1 id='build'>Build</h1><h2 id='docker'>Docker</h2><h3 id='git-repository'>Git repository</h3>
<p>Clone <code>iroha</code> repository on your directory.</p>

<blockquote>
<p>Cloning Iroha</p>
</blockquote>
<pre class="highlight shell"><code>git clone -b develop --depth<span class="o">=</span>1 <span class="se">\</span>
https://github.com/hyperledger/iroha /path/to/iroha
</code></pre><h3 id='how-to-run-development-environment'>How to run development environment</h3><pre class="highlight shell"><code>/path/to/iroha/scripts/run-iroha-dev.sh
</code></pre>
<p>You will be attached to interactive environment for development and testing with <code>iroha</code> folder mounted from host machine.</p>

<p>Docker environment will be removed when you logout from the container.</p>
<h3 id='build-code-iroha-code-and-run-tests'>Build <code>iroha</code> and run tests</h3>
<p>Build:
<code>bash
cmake -H. -Bbuild; 
cmake --build build -- -j$(nproc)
</code></p>

<p><code>irohad</code> and <code>iroha-cli</code> binaries will be in <code>./build/bin</code> directory.</p>

<blockquote>
<p>How to run tests method #1</p>
</blockquote>
<pre class="highlight shell"><code>cmake --build build --target <span class="nb">test</span>
</code></pre>
<blockquote>
<p>How to run tests method #2</p>
</blockquote>
<pre class="highlight shell"><code>ctest . <span class="c"># in build folder </span>
</code></pre><h3 id='execute-code-iroha-cli-code-with-code-irohad-code-running'>Execute <code>iroha-cli</code> with <code>irohad</code> running</h3>
<p>Execute <code>run-iroha-dev.sh</code> again to attach to existing container.</p>
<h2 id='linux-or-macos'>Linux or macOS</h2>
<blockquote>
<p>Linux</p>
</blockquote>
<pre class="highlight shell"><code>apt-get -y --no-install-recommends install <span class="se">\</span>
        build-essential python-software-properties <span class="se">\</span>
        automake libtool <span class="se">\</span>
        libssl-dev zlib1g-dev libboost-all-dev <span class="se">\</span>
        libc6-dbg golang <span class="se">\</span>
        git ssh tar gzip ca-certificates <span class="se">\</span>
        python3 python3-pip python3-setuptools <span class="se">\</span>
        lcov <span class="se">\</span>
        wget curl cmake file unzip gdb <span class="se">\</span>
        iputils-ping vim ccache <span class="se">\</span>
        gcovr vera++ cppcheck doxygen <span class="se">\</span>
        graphviz graphviz-dev; <span class="se">\</span>
    apt-get -y clean
git clone https://github.com/hyperledger/iroha -b develop
<span class="nb">cd </span>iroha
cmake -H. -Bbuild
cmake --build build -- -j4
</code></pre>
<blockquote>
<p>macOS</p>
</blockquote>
<pre class="highlight shell"><code>xcode-select --install
<span class="c"># if you dont't have brew installed</span>
ruby -e <span class="s2">"</span><span class="k">$(</span>curl -fsSL https://raw.githubusercontent.com/homebrew/install/master/install<span class="k">)</span><span class="s2">"</span>
brew install cmake boost postgres grpc autoconf automake libtool golang
git clone https://github.com/hyperledger/iroha -b develop
<span class="nb">cd </span>iroha
cmake -H. -Bbuild
cmake --build build -- -j4
</code></pre>
<blockquote>
<p>macOS brew</p>
</blockquote>
<pre class="highlight shell"><code>brew tap soramitsu/iroha
brew install iroha
</code></pre><h1 id='transactions'>Transactions</h1>
<blockquote>
<p>Transaction </p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">Transaction</span> <span class="p">{</span>
  <span class="n">Payload</span> <span class="na">payload</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">repeated</span> <span class="n">Signature</span> <span class="na">signature</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
 <span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="err">/*</span><span class="w"> </span><span class="err">Transaction</span><span class="w"> </span><span class="err">*/</span><span class="w">
    </span><span class="s2">"signatures"</span><span class="p">:</span><span class="w"> </span><span class="err">array</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">objects</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_ts"</span><span class="p">:</span><span class="w"> </span><span class="err">int(</span><span class="mi">13</span><span class="err">)</span><span class="p">,</span><span class="w">
    </span><span class="s2">"creator_account_id"</span><span class="p">:</span><span class="w"> </span><span class="err">string(?)</span><span class="p">,</span><span class="w">
    </span><span class="s2">"tx_counter"</span><span class="p">:</span><span class="w"> </span><span class="err">int</span><span class="p">,</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="err">array</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">objects</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>To provide connectivity with Iroha, currently Google RPC is used. To form a transaction with one or many commands, or send a query JSON format is used in CLI.</p>

<p>Client application should follow descibed protocol and form transactions accordingly to description below.</p>
<h2 id='transaction-structure'>Transaction structure</h2>
<p>Each transaction consists of two parts:
<ul>
    <li> Payload </li> 
    <li> Signature </li> 
</ul></p>

<blockquote>
<p>Payload</p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">Payload</span> <span class="p">{</span>
  <span class="k">repeated</span> <span class="n">Command</span> <span class="na">commands</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="kt">string</span> <span class="na">creator_account_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="kt">uint64</span> <span class="na">tx_counter</span>  <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="kt">uint64</span> <span class="na">created_time</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="err">string(?)</span><span class="p">,</span><span class="w">
            </span><span class="err">/*</span><span class="w"> </span><span class="err">other</span><span class="w"> </span><span class="err">command-specific</span><span class="w"> </span><span class="err">fields</span><span class="w"> </span><span class="err">*/</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"creator_account_id"</span><span class="p">:</span><span class="w"> </span><span class="err">string(?)</span><span class="p">,</span><span class="w">
    </span><span class="s2">"tx_counter"</span><span class="p">:</span><span class="w"> </span><span class="err">int</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_ts"</span><span class="p">:</span><span class="w"> </span><span class="err">int(</span><span class="mi">13</span><span class="err">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Signature </p>

<p>one or more signatures of payload</p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">Signature</span> <span class="p">{</span>
   <span class="kt">bytes</span> <span class="na">pubkey</span>    <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kt">bytes</span> <span class="na">signature</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"signatures"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"pubkey"</span><span class="p">:</span><span class="w"> </span><span class="err">string(</span><span class="mi">64</span><span class="err">)</span><span class="p">,</span><span class="w">
            </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> </span><span class="err">string(</span><span class="mi">128</span><span class="err">)</span><span class="p">,</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>Payload</strong> stores everything except signatures: 
<ul>
    <li> Time of creation (unix time, in milliseconds) </li> 
    <li> ID of transaction creator (username@domain) </li>
    <li> Transaction counter — counts how many times transaction creator send transactions in total. Counter is used to prevent replays, and is formed on client side. </li>
    <li> Repeated commands which would be described in details later</li> 
</ul></p>

<p><strong>Signatures</strong> contain one or many signatures (ed25519 pubkey + signature):</p>

<aside class="notice">
In preview version, there is no way to get current transaction counter by any means. You have to remember it on a client side and increment it. In future version this will be changed, and client application may retrieve this information.
</aside>
<h1 id='commands'>Commands</h1>
<aside class="warning">
Currently, docs are updated. Sections with contraints and validation parts are gradally updated.
</aside>
<h2 id='add-asset-quantity'>Add asset quantity</h2><h3 id='purpose'>Purpose</h3>
<p>Purpose of <em>add asset quantity</em> is to increase amount of assets on some account. </p>
<h3 id='structure'>Structure</h3><pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">AddAssetQuantity</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">string</span> <span class="na">asset_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">Amount</span> <span class="na">amount</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AddAssetQuantity"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"asset_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"coin#test"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="err">object</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>account id in which to add asset</td>
<td>username@domain</td>
</tr>
<tr>
<td>Asset ID</td>
<td>id of the asset</td>
<td>asset#account</td>
</tr>
<tr>
<td>Amount</td>
<td>positive amount of the asset to add</td>
<td>&gt; 0</td>
</tr>
</tbody></table>
<h3 id='validation'>Validation</h3>
<p>?</p>
<h2 id='add-peer'>Add peer</h2><h3 id='purpose-2'>Purpose</h3>
<p>Purpose of <em>add peer</em> is to write into ledger fact of peer addition into the peer network.</p>
<h3 id='structure-2'>Structure</h3><pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">AddPeer</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">address</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">bytes</span> <span class="na">peer_key</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AddPeer"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"192.168.1.1:50001"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"peer_key"</span><span class="p">:</span><span class="w"> </span><span class="err">string(</span><span class="mi">64</span><span class="err">)</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Address</td>
<td>resolvable address in network (IPv4, IPv6, domain name, etc.)</td>
<td>should be resolvable</td>
</tr>
<tr>
<td>Peer key</td>
<td>peer public key, which will be used in consensus algorithm to sign-off vote, commit, reject messages</td>
<td><strong>?</strong></td>
</tr>
</tbody></table>
<h3 id='validation-2'>Validation</h3>
<p>?</p>
<h2 id='add-signatory'>Add signatory</h2><h3 id='purpose-3'>Purpose</h3>
<p>Purpose of <em>add signatory</em> is to add identity to the account. It can be the public key of another device or public key of another user.</p>
<h3 id='structure-3'>Structure</h3><pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">AddSignatory</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">bytes</span> <span class="na">public_key</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AddSignatory"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"public_key"</span><span class="p">:</span><span class="w"> </span><span class="err">string(</span><span class="mi">64</span><span class="err">)</span><span class="w"> 
        </span><span class="p">}</span><span class="w"> 
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>Account in which to add signatory (username@domain)</td>
<td>username@domain</td>
</tr>
<tr>
<td>Public key</td>
<td>Signatory to add to account</td>
<td>ed25519 public key</td>
</tr>
</tbody></table>
<h3 id='validation-3'>Validation</h3>
<p>?</p>
<h2 id='create-asset'>Create asset</h2><h3 id='purpose-4'>Purpose</h3>
<p>Purpose of <em>сreate asset</em> is to create new type of asset, specific for a domain.</p>
<h3 id='structure-4'>Structure</h3><pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">CreateAsset</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">asset_name</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">string</span> <span class="na">domain_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="kt">uint32</span> <span class="na">precision</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CreateAsset"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"asset_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"usd"</span><span class="p">,</span><span class="w"> 
            </span><span class="s2">"domain_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w"> 
            </span><span class="s2">"precision"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="w">
        </span><span class="p">}</span><span class="w"> 
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Asset name</td>
<td>domain-unique name for asset</td>
<td><strong>?</strong></td>
</tr>
<tr>
<td>Domain ID</td>
<td>target domain to make relation with</td>
<td>should be created before the asset, length — <strong>?</strong></td>
</tr>
<tr>
<td>Precision</td>
<td>number of digits after comma/dot</td>
<td>0 &lt;= precision &lt;= uint32 max</td>
</tr>
</tbody></table>
<h3 id='validation-4'>Validation</h3>
<p>?</p>
<h2 id='create-account'>Create account</h2><h3 id='purpose-5'>Purpose</h3>
<p>Purpose of <em>create account</em> is to make new entity similar to wallet, which stores assets and identities.</p>
<h3 id='structure-5'>Structure</h3><pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">CreateAccount</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">account_name</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">string</span> <span class="na">domain_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="kt">bytes</span> <span class="na">main_pubkey</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CreateAccount"</span><span class="p">,</span><span class="w"> 
            </span><span class="s2">"account_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"takemiya"</span><span class="p">,</span><span class="w"> 
            </span><span class="s2">"domain_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w"> 
            </span><span class="s2">"main_pubkey"</span><span class="p">:</span><span class="w"> </span><span class="err">string(</span><span class="mi">64</span><span class="err">)</span><span class="w">
        </span><span class="p">}</span><span class="w"> 
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account name</td>
<td>domain-unique name for account</td>
<td><strong>?</strong></td>
</tr>
<tr>
<td>Domain ID</td>
<td>target domain to make relation with</td>
<td>should be created before the account, length is <strong>?</strong></td>
</tr>
<tr>
<td>Main pubkey</td>
<td>first piblic key to add into the account</td>
<td>ed25519 public key</td>
</tr>
</tbody></table>
<h3 id='validation-5'>Validation</h3>
<p>?</p>
<h2 id='create-domain'>Create domain</h2><h3 id='purpose-6'>Purpose</h3>
<p>Purpose of <em>create domain</em> is to make new domain in Iroha network.</p>
<h3 id='structure-6'>Structure</h3>
<aside class="notice">
Just in case it is not working — it was suggested to rename domain_name field into domain_id on 24th of September for consistency across the project.
</aside>

<aside class="notice">
Also, regarding recent API changes, we are going to add _default role_ in account so that any created account in this domain has this role by default.
</aside>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">CreateDomain</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">domain_name</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CreateDomain"</span><span class="p">,</span><span class="w"> 
            </span><span class="s2">"domain_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test2"</span><span class="w">
        </span><span class="p">}</span><span class="w"> 
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Domain ID</td>
<td>ID for created domain</td>
<td>unique, regex is <strong>?</strong></td>
</tr>
</tbody></table>
<h3 id='validation-6'>Validation</h3>
<ul>
<li><em>domain id</em> is unique and valid against regex</li>
<li>Account, who sends this command in transaction, has permission to create domain</li>
</ul>
<h2 id='remove-signatory'>Remove signatory</h2><h3 id='purpose-7'>Purpose</h3>
<p>Purpose of <em>remove signatory</em> is to remove public key, associated with an identity, from an account</p>
<h3 id='structure-7'>Structure</h3><pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">RemoveSignatory</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">bytes</span> <span class="na">public_key</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RemoveSignatory"</span><span class="p">,</span><span class="w"> 
            </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"takemiya@test"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"public_key"</span><span class="p">:</span><span class="w"> </span><span class="err">string(</span><span class="mi">64</span><span class="err">)</span><span class="w">
        </span><span class="p">}</span><span class="w"> 
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>ID of account to delete signatory from</td>
<td>already existent, regex is <strong>?</strong></td>
</tr>
</tbody></table>
<h3 id='validation-7'>Validation</h3>
<p>When signatory is deleted, we should check if invariant of <strong>size(signatories) &gt;= quorum</strong> holds</p>
<h2 id='set-account-quorum'>Set account quorum</h2><h3 id='purpose-8'>Purpose</h3>
<p>Purpose of <em>set account quorum</em> is to set the number of signatories needed to confirm the identity of person, sending the transaction or is to set amount of people to agree on transaction contents.</p>
<h3 id='structure-8'>Structure</h3><pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">SetAccountQuorum</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">uint32</span> <span class="na">quorum</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SetAccountQuorum"</span><span class="p">,</span><span class="w"> 
            </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"takemiya@test"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"quorum"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>ID of account to set quorum</td>
<td>already existent, regex is <strong>?</strong></td>
</tr>
<tr>
<td>Quorum</td>
<td>number of signatories needed to be included with a transaction from this account</td>
<td># less than</td>
</tr>
</tbody></table>
<h3 id='validation-8'>Validation</h3>
<p>When quorum is set, we should check if invariant of <strong>size(signatories) &gt;= quorum</strong> holds</p>
<h2 id='transfer-asset'>Transfer asset</h2><h3 id='purpose-9'>Purpose</h3>
<p>Purpose of <em>transfer asset</em> is to share assets across the network, so that source account can transfer assets to target account.</p>
<h3 id='structure-9'>Structure</h3><pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">TransferAsset</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">src_account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">string</span> <span class="na">dest_account_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="kt">string</span> <span class="na">asset_id</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="n">Amount</span> <span class="na">amount</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TransferAsset"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"src_account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"takemiya@test"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dest_account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nikolai@test"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"asset_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"coin#test"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"int_part"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> 
                </span><span class="s2">"precision"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Source account ID</td>
<td>ID of account to withdraw asset from</td>
<td>already existent, regex is <strong>?</strong></td>
</tr>
<tr>
<td>Destination account ID</td>
<td>ID of account to send asset at</td>
<td>already existent</td>
</tr>
<tr>
<td>Asset ID</td>
<td>ID of asset to use</td>
<td>already existent</td>
</tr>
<tr>
<td>Amount</td>
<td>amount of asset to transfer</td>
<td><strong>?</strong></td>
</tr>
</tbody></table>
<h3 id='validation-9'>Validation</h3>
<p>?</p>
<h2 id='subtract-asset-quantity'>Subtract asset quantity</h2><h3 id='purpose-10'>Purpose</h3>
<p>Purpose of <em>subtract asset quantity</em> is to decrease amount of asset, belonging to an account.</p>
<h3 id='structure-10'>Structure</h3>
<aside class="warning">
This command is not implemented currently.
</aside>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>?</td>
<td>?</td>
<td>?</td>
</tr>
</tbody></table>
<h3 id='validation-10'>Validation</h3>
<p>?</p>
<h2 id='append-role'>Append role</h2><h3 id='purpose-11'>Purpose</h3>
<p>Purpose of <em>append role</em> is to promote an account to some created role in the system, where role is a set or permissions account has to perform an action (command or query).</p>
<h3 id='structure-11'>Structure</h3><pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">AppendRole</span> <span class="p">{</span>
   <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kt">string</span> <span class="na">role_name</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AppendRole"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"takemiya@test"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"role_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Administrator"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>id or account to append role to</td>
<td>already existent, regex is <strong>?</strong></td>
</tr>
<tr>
<td>Role name</td>
<td>name of already created role</td>
<td>already existent</td>
</tr>
<tr>
<td>Amount</td>
<td>amount of asset to transfer</td>
<td><strong>?</strong></td>
</tr>
</tbody></table>
<h3 id='validation-11'>Validation</h3>
<p>?</p>
<h2 id='create-role'>Create role</h2><h3 id='purpose-12'>Purpose</h3>
<p>Purpose of <em>create role</em> is to create new role in the system from the set of permissions.
Combining different permissions into roles, maintainers of Iroha peer network can create customized security model.</p>
<h3 id='structure-12'>Structure</h3><pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">CreateRole</span> <span class="p">{</span>
   <span class="kt">string</span> <span class="na">role_name</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="k">repeated</span> <span class="kt">string</span> <span class="na">permissions</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CreateRole"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"role_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MoneyCreator"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"permissions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"CanAddAssetQuantity"</span><span class="p">,</span><span class="w">
                </span><span class="err">…</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Role name</td>
<td>name of role to create</td>
<td>regex?</td>
</tr>
<tr>
<td>Permissions</td>
<td>array of already existent permissions</td>
<td><strong>?</strong></td>
</tr>
</tbody></table>
<h3 id='validation-12'>Validation</h3>
<p>?</p>
<h2 id='grant-permission'>Grant permission</h2><h3 id='purpose-13'>Purpose</h3>
<p>Purpose of <em>grant permission</em> is to give another account in the system rights to perform actions over account of transaction sender (give someone right to do something with my account).</p>
<h3 id='structure-13'>Structure</h3><pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">GrantPermission</span> <span class="p">{</span>
   <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kt">string</span> <span class="na">permission_name</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GrantPermission"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"takemiya@soramitsu"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"permission_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CanAddAssetQuantity"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>id of account whom rights are granted</td>
<td>should be existent in the system</td>
</tr>
<tr>
<td>Permission name</td>
<td>name of granted permission</td>
<td><strong>?</strong></td>
</tr>
</tbody></table>
<h3 id='validation-13'>Validation</h3>
<p>?</p>
<h2 id='revoke-permission'>Revoke permission</h2><h3 id='purpose-14'>Purpose</h3>
<p>Purpose of <em>revoke permission</em> is to revoke or dismiss given grant permission to another account in the netw</p>
<h3 id='structure-14'>Structure</h3><pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">RevokePermission</span> <span class="p">{</span>
   <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kt">string</span> <span class="na">permission_name</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"command_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RevokePermission"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"takemiya@soramitsu"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"permission_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CanAddAssetQuantity"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w"> </span><span class="err">…</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>id of account whom rights were granted</td>
<td>should be existent in the system</td>
</tr>
<tr>
<td>Permission name</td>
<td>name of revoked permission</td>
<td><strong>?</strong></td>
</tr>
</tbody></table>
<h3 id='validation-14'>Validation</h3>
<p>?</p>
<h1 id='queries'>Queries</h1><h2 id='query-structure'>Query structure</h2><pre class="highlight protobuf tab-protobuf"><code> <span class="kd">message</span> <span class="nc">Query</span> <span class="p">{</span>
    <span class="kd">message</span> <span class="nc">Header</span> <span class="p">{</span>
        <span class="kt">uint64</span> <span class="na">created_time</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">Signature</span> <span class="na">signature</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>

   <span class="n">Header</span> <span class="na">header</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="kt">string</span> <span class="na">creator_account_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

   <span class="k">oneof</span> <span class="n">query</span> <span class="p">{</span>
        <span class="n">GetAccount</span> <span class="na">get_account</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
        <span class="n">GetSignatories</span> <span class="na">get_account_signatories</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
        <span class="n">GetAccountTransactions</span> <span class="na">get_account_transactions</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
        <span class="n">GetAccountAssetTransactions</span> <span class="na">get_account_asset_transactions</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
        <span class="n">GetAccountAssets</span> <span class="na">get_account_assets</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
        <span class="n">GetRoles</span> <span class="na">get_roles</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
        <span class="n">GetAssetInfo</span> <span class="na">get_asset_info</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
        <span class="n">GetRolePermissions</span> <span class="na">get_role_permissions</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">uint64</span> <span class="na">query_counter</span> <span class="o">=</span> <span class="mi">11</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre>
<p>Each query consists of following things:
<ol>
    <li> Header </li>
    <li> Creator account_id </li>
    <li> Query (one of Query type) object </li>
    <li> Query counter </li>
</ol></p>

<p><strong>Header</strong> stores: 
<ul>
    <li>  time of creation (unix time, in milliseconds) </li> 
    <li>  single signature (ed25519 pubkey + signature — singed message with private key) </li> 
</ul></p>

<p><strong>Creator account_id</strong> stores account id in form username@domain <br>
<strong>Query object</strong> might be any of types, described below <br>
<strong>Query counter</strong> is used to prevent replay attack and it is formed on client side</p>
<h2 id='get-account'>Get account</h2><h3 id='purpose'>Purpose</h3>
<p>Purpose of <em>get account</em> query is to get state of an account.</p>

<p>Given this Query, in successful case Iroha returns <code>AccountResponse</code>, which contains Account object with following fields:
<ul>
    <li>account_id </li>
    <li>domain_name </li>
    <li>permissions object </li>
    <li>quorum — the quantity of signatures to pass within transaction to execute commands for this account </li>
</ul></p>

<aside class="warning"> `AccountResponse` should not contain array of permissions, but an array of `Role` object instead. It will be reworked. </aside>
<h3 id='structure'>Structure</h3><h4 id='query'>Query</h4>
<blockquote>
<p>Query</p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">GetAccount</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"pubkey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="s2">"created_ts"</span><span class="p">:</span><span class="w"> </span><span class="err">…</span><span class="p">,</span><span class="w">
    </span><span class="s2">"creator_account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@test"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_counter"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GetAccount"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>account id to request its state</td>
<td>username@domain</td>
</tr>
</tbody></table>
<h4 id='response'>Response</h4>
<blockquote>
<p>Response </p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">AccountResponse</span> <span class="p">{</span>
    <span class="n">Account</span> <span class="na">account</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">message</span> <span class="nc">Account</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">string</span> <span class="na">domain_name</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">Permissions</span> <span class="na">permissions</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="kt">uint32</span> <span class="na">quorum</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>account id</td>
<td>username@domain</td>
</tr>
<tr>
<td>Domain name</td>
<td>domain of account id</td>
<td>?</td>
</tr>
<tr>
<td>Permissions</td>
<td>set of allowed permissions for the account</td>
<td>?</td>
</tr>
<tr>
<td>Quorum</td>
<td>number of signatories needed to sign the transaction to make it valid</td>
<td>integer</td>
</tr>
</tbody></table>

<aside class="notice">It is better to rename `domain_name` into `domain_id` for consistency purposes</aside>
<h3 id='validation'>Validation</h3>
<p>?</p>
<h2 id='get-signatories'>Get signatories</h2><h3 id='purpose-2'>Purpose</h3>
<p>Purpose of _get signatories query is to get signatories, which act as an identity of the account.</p>

<p>Given this Query, in successful case Iroha returns <code>SignatoriesResponse</code>, which is one or many public ed25519 keys.</p>
<h3 id='structure-2'>Structure</h3><h4 id='query-2'>Query</h4>
<blockquote>
<p>Query</p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">GetSignatories</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"pubkey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="s2">"created_ts"</span><span class="p">:</span><span class="w"> </span><span class="err">…</span><span class="p">,</span><span class="w">
    </span><span class="s2">"creator_account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@test"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_counter"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GetSignatories"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>account id to request signatories</td>
<td>username@domain</td>
</tr>
</tbody></table>
<h4 id='response-2'>Response</h4>
<blockquote>
<p>Response </p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">SignatoriesResponse</span> <span class="p">{</span>
    <span class="k">repeated</span> <span class="kt">bytes</span> <span class="na">keys</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Keys</td>
<td>an array of public keys</td>
<td>ed25519</td>
</tr>
</tbody></table>
<h3 id='validation-2'>Validation</h3>
<p>?</p>
<h2 id='get-account-transactions'>Get account transactions</h2><h3 id='purpose-3'>Purpose</h3>
<p>In case when a list of transactions per user is needed, <code>GetAccountTransactions</code> query can be formed.</p>

<p>Given this Query, in successful case Iroha returns <code>TransactionsResponse</code>, which is a collection of transactions.</p>

<aside class="notice">Team of Iroha maintainers is implementing pagination for this query, so that user can retrive transactions partially, using tx_hash as head, and quantity as size of page</aside>
<h3 id='structure-3'>Structure</h3><h4 id='query-3'>Query</h4>
<blockquote>
<p>Query</p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">GetAccountTransactions</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"pubkey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="s2">"created_ts"</span><span class="p">:</span><span class="w"> </span><span class="err">…</span><span class="p">,</span><span class="w">
    </span><span class="s2">"creator_account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@test"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_counter"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GetAccountTransactions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>account id to request transactions from</td>
<td>username@domain</td>
</tr>
</tbody></table>
<h4 id='response-3'>Response</h4>
<blockquote>
<p>Response </p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">TransactionsResponse</span> <span class="p">{</span>
    <span class="k">repeated</span> <span class="n">Transaction</span> <span class="na">transactions</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Transactions</td>
<td>an array of transactions for given account</td>
<td>?</td>
</tr>
</tbody></table>
<h3 id='validation-3'>Validation</h3>
<p>?</p>
<h2 id='get-account-asset-transactions'>Get account asset transactions</h2><h3 id='purpose-4'>Purpose</h3>
<p>When an information about transaction per user using certain asset is needed, <code>GetAccountAssetTransactions</code> query is sent.</p>

<p>Given this Query, in successful case Iroha returns <code>TransactionsResponse</code>, which is a collection of transactions.</p>
<h3 id='structure-4'>Structure</h3><h4 id='query-4'>Query</h4>
<blockquote>
<p>Query</p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">GetAccountAssetTransactions</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">string</span> <span class="na">asset_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"pubkey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="s2">"created_ts"</span><span class="p">:</span><span class="w"> </span><span class="err">…</span><span class="p">,</span><span class="w">
    </span><span class="s2">"creator_account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@test"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_counter"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GetAccountAssetTransactions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"asset_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"coin#test"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>account id to request transactions from</td>
<td>username@domain</td>
</tr>
<tr>
<td>Asset ID</td>
<td>asset id in order to filter transactions containing this asset</td>
<td>username@domain</td>
</tr>
</tbody></table>
<h4 id='response-4'>Response</h4>
<blockquote>
<p>Response </p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">TransactionsResponse</span> <span class="p">{</span>
    <span class="k">repeated</span> <span class="n">Transaction</span> <span class="na">transactions</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Transactions</td>
<td>an array of transactions for given account and asset</td>
<td>?</td>
</tr>
</tbody></table>
<h3 id='validation-4'>Validation</h3>
<p>?</p>
<h2 id='get-account-assets'>Get account assets</h2><h3 id='purpose-5'>Purpose</h3>
<p>To know the state of an asset per account (balance), <code>GetAccountAssets</code> query can be formed.</p>

<p>Given this Query, in successful case Iroha returns <code>AccountAssetResponse</code>.</p>
<h3 id='structure-5'>Structure</h3><h4 id='query-5'>Query</h4>
<blockquote>
<p>Query</p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">GetAccountAssets</span> <span class="p">{</span>
 <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
 <span class="kt">string</span> <span class="na">asset_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"pubkey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="s2">"created_ts"</span><span class="p">:</span><span class="w"> </span><span class="err">…</span><span class="p">,</span><span class="w">
    </span><span class="s2">"creator_account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@test"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_counter"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GetAccountAssets"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"asset_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"coin#test"</span><span class="p">,</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Account ID</td>
<td>account id to request balance from</td>
<td>username@domain</td>
</tr>
<tr>
<td>Asset ID</td>
<td>asset id to know its balance</td>
<td>asset#domain</td>
</tr>
</tbody></table>
<h4 id='response-5'>Response</h4>
<blockquote>
<p>Response </p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">AccountAsset</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">asset_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">string</span> <span class="na">account_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">Amount</span> <span class="na">balance</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span> <span class="nc">AccountAssetResponse</span> <span class="p">{</span>
    <span class="n">AccountAsset</span> <span class="na">account_asset</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Asset ID</td>
<td>asset id to knows its balance</td>
<td>?</td>
</tr>
<tr>
<td>Account ID</td>
<td>account which has this balance</td>
<td>?</td>
</tr>
<tr>
<td>Balance</td>
<td>balance of asset</td>
<td>?</td>
</tr>
</tbody></table>
<h3 id='validation-5'>Validation</h3>
<p>?</p>
<h2 id='get-asset-info'>Get asset info</h2><h3 id='purpose-6'>Purpose</h3>
<p>In order to know precision for given asset, and other related info in future, such as description, etc. user can send <code>GetAssetInfo</code> query to Iroha network </p>

<p>Given this Query, in successful case Iroha returns <code>AssetResponse</code> with an infomation about the asset.</p>
<h3 id='structure-6'>Structure</h3><h4 id='query-6'>Query</h4>
<blockquote>
<p>Query</p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">GetAssetInfo</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">asset_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"pubkey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="s2">"created_ts"</span><span class="p">:</span><span class="w"> </span><span class="err">…</span><span class="p">,</span><span class="w">
    </span><span class="s2">"creator_account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@test"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_counter"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GetAssetInfo"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"asset_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"coin#test"</span><span class="p">,</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Asset ID</td>
<td>asset id to know related information</td>
<td>asset#domain</td>
</tr>
</tbody></table>
<h4 id='response-6'>Response</h4>
<blockquote>
<p>Response </p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">AssetResponse</span> <span class="p">{</span>
<span class="n">Asset</span> <span class="na">asset</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span> <span class="nc">Asset</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">asset_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">string</span> <span class="na">domain_id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="kt">uint32</span> <span class="na">precision</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Asset ID</td>
<td>asset id to get information about</td>
<td>?</td>
</tr>
<tr>
<td>Domain ID</td>
<td>domain related to this asset</td>
<td>?</td>
</tr>
<tr>
<td>Precision</td>
<td>number of digits after comma</td>
<td>?</td>
</tr>
</tbody></table>
<h3 id='validation-6'>Validation</h3>
<p>?</p>
<h2 id='get-roles'>Get roles</h2><h3 id='purpose-7'>Purpose</h3>
<p>To get available roles in the system, user can send <code>GetRoles</code> query to Iroha network.</p>

<p>Given this Query, in successful case Iroha returns <code>RolesResponse</code> containing array of existing roles. </p>
<h3 id='structure-7'>Structure</h3><h4 id='query-7'>Query</h4>
<blockquote>
<p>Query</p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">GetRoles</span> <span class="p">{</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"pubkey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="s2">"created_ts"</span><span class="p">:</span><span class="w"> </span><span class="err">…</span><span class="p">,</span><span class="w">
    </span><span class="s2">"creator_account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@test"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_counter"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GetRoles"</span><span class="p">,</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h4 id='response-7'>Response</h4>
<blockquote>
<p>Response </p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">RolesResponse</span> <span class="p">{</span>
    <span class="k">repeated</span> <span class="kt">string</span> <span class="na">roles</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Roles</td>
<td>array of created roles in the network</td>
<td>?</td>
</tr>
</tbody></table>
<h3 id='validation-7'>Validation</h3>
<p>?</p>
<h2 id='get-role-permissions'>Get role permissions</h2><h3 id='purpose-8'>Purpose</h3>
<p>To get available permissions per role in the system, user can send <code>GetRolePermissions</code> query to Iroha network.</p>

<p>Given this Query, in successful case Iroha returns <code>RolePermissionsResponse</code> containing array of permissions related to the role. </p>
<h3 id='structure-8'>Structure</h3><h4 id='query-8'>Query</h4>
<blockquote>
<p>Query</p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">GetRolePermissions</span> <span class="p">{</span> 
    <span class="kt">string</span> <span class="na">role_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"pubkey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"…"</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="s2">"created_ts"</span><span class="p">:</span><span class="w"> </span><span class="err">…</span><span class="p">,</span><span class="w">
    </span><span class="s2">"creator_account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@test"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_counter"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"query_type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GetRolePermissions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"role_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"MoneyCreator"</span><span class="p">,</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Role ID</td>
<td>role to get permissions for</td>
<td>?</td>
</tr>
</tbody></table>
<h4 id='response-8'>Response</h4>
<blockquote>
<p>Response </p>
</blockquote>
<pre class="highlight protobuf tab-protobuf"><code><span class="kd">message</span> <span class="nc">RolePermissionsResponse</span> <span class="p">{</span>
    <span class="k">repeated</span> <span class="kt">string</span> <span class="na">permissions</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Constraint</th>
</tr>
</thead><tbody>
<tr>
<td>Permissions</td>
<td>array of permissions related to the role</td>
<td>?</td>
</tr>
</tbody></table>
<h3 id='validation-8'>Validation</h3>
<p>?</p>
<h1 id='command-line-interface'>Command Line Interface</h1>
<p>Iroha Command Line Interface (CLI) is a tool for creation of transaction containing commands from the command line, or sending queries to Iroha. It is intended to simplify interaction between the client side and Iroha peer. </p>

<p>Interactive mode of cli in a nutshell represents number of steps, where at each step user must interact with the system. 
To choose one of the options can type short name of the command specified in parentheses, or number of the command in the menu.</p>
<h2 id='interactive-mode'>Interactive mode </h2>
<p>Run: 
<code class="bash"> iroha-cli --interactive --name your_account_id </code></p>

<p>Your account_id will be used as the creator of the queries and transactions, signing up messages with accounts keys, fill up counters. 
At the start of interactive cli will try to find locally keypairs associated with the account_id, hence this keypairs must be generated and stored locally. </p>
<h2 id='starting-menu'>Starting menu </h2>
<p>At the start of cli user has two possible modes:</p>

<ul>
<li>Start a transaction</li>
<li>Start a query</li>
</ul>

<p><img src="images/cli/image.png" alt="image" /></p>
<h2 id='transaction-cli'>Transaction CLI</h2>
<p>Start up of transaction cli will trigger the creation of a new transaction.
Each transaction consists of commands, being less or equal than <strong>65000</strong>. User is offered to add commands to new formed transaction.
All meta data of transaction will be filled automatically (signature, tx_counter, creator account, timestamp).
Currently following Iroha commands are supported in Interactive CLI:</p>

<p><img src="images/cli/image-2.png" alt="image-2" /></p>

<p>Back option will switch back to main menu. 
To add command to transaction there two options:
<ol> 
    <li> Type number of the command in the menu, or command name without parameters: 
    This will iterate through the parameters of the command and ask user to type the parameter value. 
    For example typing &quot;1&quot; will create set account quorum, and ask to type account id and quorum: 
    <img src="images/cli/image-4.png" alt="image-3" /> </li> </p>

<p><li> Type command name with all needed parameters . 
    This option can be used to quickly add command to transaction. For example typing: 
    <code>set_qrm test@test 2</code> - will create Set_Account_Quorum command for account: <code>test@test</code> and quorum: 2. </li> 
</ol></p>

<p>After addition of the command, result menu will be printed:  
<img src="images/cli/image-4.png" alt="image-4" /></p>

<ol>

    <li> User can add more commands to the same transaction </li>  
    <li> User can send to Iroha peer </li>
    <li> Go back and create new transaction (this will delete previous transaction) </li>
    <li> Save transaction as json file locally </li>
</ol>
<h2 id='query-cli'>Query CLI</h2>
<p>Interactive query cli is build similarly as Transaction CLI.
Query meta data will be assigned automatically (query_counter, time_stamp,  creator_account, signature)
Currently interactive cli supports the following queries:</p>

<p><img src="images/cli/image-5.png" alt="image-5" /></p>

<p>For each query there two possible modes to run: 
<ol>
    <li> By typing appropriate number of query, either the corresponding abbreviation specified in parentheses. </li> 
    <li> Typing the command abbreviation with appropriated parameters. </li> 
</ol> </p>

<p>After query is formed there are following options:
<ul> 
    <li>Save query as json </li>
    <li>Send to Iroha Peer and receive QueryResponse </li>
    <li>Back option, will return to query choice menu and remove current query. </li>
</ul></p>

<p><img src="images/cli/image-6.png" alt="image-6" /></p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="protobuf">protobuf</a>
                <a href="#" data-language-name="json">json</a>
          </div>
      </div>
    </div>
    <button class="js-gitter-toggle-chat-button" data-gitter-toggle-chat-state="true">Open Chat</button>
    </body>
</html>
